# 浏览器渲染机制

浏览器是多进程的，主要进程有Browser进程、第三方插件进程、GPU进程、浏览器渲染进程。

1. Brower 进程:浏览器的主进程(负责协调
   * 负责浏览器界面显示\与用户交互.如

**浏览器渲染进程**就是每个Tab页面的进程，互不影响，主要作用是页面渲染、脚本执行、事件处理等。对于普通的前端的操作来说，主要是关心渲染进程。

**浏览器的渲染进程是多线程的**，有下面几个主要的线程

1. GUI 渲染线程
   * 负责渲染浏览器界面，解析HTML、CSS，构建DOM树和CSSOM树，构建Render Tree,计算节点位置，进行绘制等。
   * 当界面需要重绘或回流时，该线程会被执行
   * 主要，GUI渲染线程和JS引擎线程是互斥的，当JS引擎执行时GUI线程会被挂起，GUI更新会被保存在一个队列中等到JS引擎空闲时立即被执行。
2. JS引擎线程
   * 也称JS内核，负责处理JS脚本程序（例如V8引擎）
   * JS引擎线程负责解析JS脚本，运行代码
   * JS引擎一直等待着**任务队列**中任务的到来，然后加以处理，一个Tab页面中无论什么时候都**只有一个JS线程**在运行JS程序
   * GUI渲染线程和JS引擎线程是互斥的
3. 事件触发线程
   * 归属于浏览器而不是JS引擎，用来控制事件循环。
   * 当JS引擎执行代码块如setTimeOut时，当浏览器内核的其他线程如鼠标点击，AJAX异步请求等，会将对应任务添加到事件线程中。
   * 当对应的事件符合触发条件被触发时,该线程会把事件添加到待处理队列的队尾,等待JS引擎的处理
   * 因为JS是单线程的关系，所以这些待处理队列中的事件都得排队等待JS引擎处理
4. 定时触发器线程
   * setInterval setTimeout所在线程
   * 浏览器定时计数器并不是由JS引擎计数的,通过单独线程来计时并触发定时(计时完毕后,添加到事件队列中,等待JS引擎空闲)
5. 异步HTTP请求线程
   * 在XMLHttpRequest 在连接后是通过浏览器新开一个线程请求
   * 将检测到状态变更时,如果设置有回调函数,异步线程就产生状态变更事件,将这个回调在再放入事件队列中,再由JS引擎执行.

























